{
  "rewrite_rules": [
    {
      "comment": [
        "Extract Correct Program Name from IBM LEEF formatted logs",
        "LEEF Formatted logs include extra metadata that are pipe deliited: ",
        "* LEEF version",
        "* Vendor Name",
        "* Product Name",
        "* Product Version",
        "* Event ID",
        "Sample: 1.0|WatchGuard|XTM|12.1.1.B558423|2CFF0000|"
      ],
      "match": [
        {
          "field": "program",
          "value": "LEEF"
        },
        {
          "field": "message",
          "op": "=~",
          "value": "(\\d\\.\\d)\\|([^|]+)\\|([^|]+)\\|([^|]+)\\|([^|]+)\\|(.*)"
        }
      ],
      "update": {
        "program": "$2",
        "message": "$6"
      },
      "tag": {
        "ibm_leef_version": "$1",
        "ibm_leef_vendor_name": "$2",
        "ibm_leef_product_name": "$3",
        "ibm_leef_product_version": "$4",
        "ibm_leef_event_id": "$5"
      }
    }
  ]
}
