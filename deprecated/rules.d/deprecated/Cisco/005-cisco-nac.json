{
  "rewrite_rules": [
    {
      "comment": "Set Cisco NAC Program Name",
      "match": {
        "field": "message",
        "op": "=*",
        "value": "NAC Policy"
      },
      "update": {
        "program": "Cisco NAC"
      }
    },
    {
      "comment": "Cisco NAC",
      "match": {
        "field": "message",
        "op": "=~",
        "value": "NAC Policy Log: Source: (\\S+),.+?Rule: Policy \"(.+?)\".*?"
      },
      "tag": {
        "ut_cisco_nac_src_ip": "$1",
        "ut_cisco_nac_policies": "$2"
      }
    },
    {
      "comment": "Cisco NAC - Block Event",
      "match": {
        "field": "message",
        "op": "=~",
        "value": "Block Event: Host: (\\S+), Target: (\\S+),.+?Service: (\\d+)\\/(\\S+).+?Reason: .+? - Limit (Inbound|Outbound)"
      },
      "tag": {
        "ut_cisco_nac_src_ip": "$1",
        "ut_cisco_nac_dst_ip": "$2",
        "ut_cisco_nac_src_port": "$3",
        "ut_cisco_nac_src_proto": "$4",
        "ut_cisco_nac_blockreasons": "Limit $5"
      }
    },
    {
      "comment": "Track Kernel Martians",
      "match": {
        "field": "message",
        "op": "=~",
        "value": "martian source (\\S+) from (\\S+)"
      },
      "tag": {
        "ut_cisco_nac_src_ip": "$2",
        "ut_cisco_nac_dst_ip": "$1"
      }
    }
  ]
}
